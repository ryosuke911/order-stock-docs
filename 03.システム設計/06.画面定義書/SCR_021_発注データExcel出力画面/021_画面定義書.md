# 発注データExcel出力画面

## 基本情報
| 項目 | 内容 |
|------|------|
| ID | SCR-021 |
| 分類 | レポート・データ出力 |
| 概要 | 発注データをExcel形式で出力するための画面 |

## 構成要素
絞り込み条件入力フォーム、Excelファイル生成ボタン、ダウンロードボタン

## 操作手順
1. 絞り込み条件を入力する（例：サプライヤー、商品、期間）。2. Excelファイル生成ボタンをクリックする。3. 生成されたExcelファイルをダウンロードする。

## アクセス権限
| 項目 | 内容 |
|------|------|
| 利用者 | 管理者 |
| 権限 | loged-in user |

## 関連ファイル
| 項目 | 内容 |
|------|------|
| ファイル名 | orderExcelOutput.tsx |
| 入力 | [{\"table\":\"orders\", \"items\":[\"order_id\", \"product_code\", \"order_quantity\", \"supplier\", \"delivery_date\", \"order_date\", \"order_status\"]}, {\"table\":\"products\", \"items\":[\"product_code\", \"product_name\"]}] |
| 出力 | null |
| 共通コンポーネントファイル | [\"Header.tsx\", \"Footer.tsx\"] |

## 入力項目の詳細仕様
| フィールド | 必須 | 型 | 制限 |
|------------|------|-----|------|
| サプライヤー | - | 選択式（ドロップダウン） | 登録済みサプライヤーから選択 |
| 商品 | - | 選択式（ドロップダウン） | 登録済み商品から選択 |
| 期間（開始） | - | 日付 | 本日以前の日付 |
| 期間（終了） | - | 日付 | 開始日以降の日付 |
| 発注状態 | - | 選択式（ドロップダウン） | 全て/発注中/納品済み/キャンセル |
| テンプレート選択 | ○ | 選択式（ドロップダウン） | 標準/詳細/サマリー |
| Excelファイル生成ボタン | - | ボタン | クリック可能状態であること |
| ダウンロードボタン | - | ボタン | Excelファイル生成後にクリック可能 |

## 入力値の検証ルール
1. 期間（開始）
   - 日付形式チェック
   - 本日以前の日付チェック
2. 期間（終了）
   - 日付形式チェック
   - 開始日以降の日付チェック
3. テンプレート選択
   - 必須選択チェック
4. Excelファイル生成
   - データ取得時の整合性チェック
   - ユーザー権限チェック
5. ダウンロード
   - ファイル生成状態チェック
   - ユーザー権限チェック

## エラーメッセージ一覧
| エラー内容 | メッセージ |
|------------|------------|
| テンプレート未選択 | 「出力テンプレートを選択してください」 |
| 日付形式エラー | 「正しい日付形式で入力してください」 |
| 期間範囲エラー | 「終了日は開始日以降の日付を指定してください」 |
| データ取得エラー | 「データの取得に失敗しました。再度実行してください」 |
| ファイル生成エラー | 「Excelファイルの生成に失敗しました。再度実行してください」 |
| 権限エラー | 「この機能の利用権限がありません」 |

## 画面遷移
| アクション | 遷移先 |
|------------|--------|
| Excelファイル生成ボタン押下 | 同画面（ダウンロードボタン有効化） |
| ダウンロードボタン押下 | ファイルダウンロード |
| キャンセルボタン押下 | 在庫管理メニュー画面 |

## 更新履歴
| 更新日 | 更新内容 | 更新者 |
|--------|----------|--------|
| 2024/03/19 | 入力項目の詳細仕様・検証ルール・エラーメッセージ・画面遷移情報を追加 | システム開発者 |
