# 操作ログ検索画面

## 基本情報
| 項目 | 内容 |
|------|------|
| ID | SCR-048 |
| 分類 | アクセス権限管理 |
| 概要 | ユーザーの操作ログを検索する画面。 |

## 構成要素
ユーザーID検索フォーム、期間指定フォーム、操作種類選択ドロップダウン、検索結果表示テーブル

## 操作手順
1. ユーザーIDを入力（または選択）します。
2. 期間を指定します。
3. 操作の種類を選択します。
4. 検索ボタンをクリックします。

## アクセス権限
| 項目 | 内容 |
|------|------|
| 利用者 | 管理者 |
| 権限 | loged-in user |

## 関連ファイル
| 項目 | 内容 |
|------|------|
| ファイル名 | /access-control/search-operation-logs.tsx |
| 入力 | [{table:"operation_logs",items:["user_id","timestamp","operation_type","data"]}] |
| 出力 | 無し |
| 共通コンポーネントファイル | ヘッダー、フッター、サイドメニュー |

## 入力項目の詳細仕様
| フィールド | 必須 | 型 | 制限 |
|------------|------|-----|------|
| ユーザーID | - | テキスト入力 | 半角英数字、4文字以上20文字以内 |
| 期間指定（開始） | ○ | 日付入力 | 本日以前の日付 |
| 期間指定（終了） | ○ | 日付入力 | 開始日以降、本日以前の日付 |
| 操作種類 | - | ドロップダウン | 以下から選択：「全て」「ログイン」「データ参照」「データ更新」「データ削除」「権限変更」 |
| 検索ボタン | - | ボタン | クリック可能状態であること |
| 検索結果表示 | - | テーブル（表示のみ） | ソート可能、ページング機能あり |
| - 操作日時 | - | 日時（表示のみ） | YYYY/MM/DD HH:mm:ss形式 |
| - ユーザーID | - | テキスト（表示のみ） | - |
| - 操作種類 | - | テキスト（表示のみ） | - |
| - 操作内容 | - | テキスト（表示のみ） | - |
| CSVダウンロードボタン | - | ボタン | クリック可能状態であること |

## 入力値の検証ルール
1. ユーザーID
   - 半角英数字チェック
   - 文字数チェック（4-20文字）
   - 存在チェック（入力時のみ）
2. 期間指定
   - 必須入力チェック
   - 日付形式チェック
   - 日付範囲の妥当性チェック
   - 期間の範囲チェック（最大1年間）
3. 操作種類
   - 選択値の有効性チェック
4. 検索操作
   - ユーザー権限チェック
   - 検索条件の組み合わせチェック

## エラーメッセージ一覧
| エラー内容 | メッセージ |
|------------|------------|
| ユーザーID形式不正 | 「ユーザーIDは半角英数字で入力してください」 |
| ユーザーID文字数不正 | 「ユーザーIDは4文字以上20文字以内で入力してください」 |
| ユーザーID不存在 | 「指定されたユーザーIDは存在しません」 |
| 期間開始日未入力 | 「期間の開始日を入力してください」 |
| 期間終了日未入力 | 「期間の終了日を入力してください」 |
| 期間日付不正 | 「正しい日付を入力してください」 |
| 期間範囲不正 | 「終了日は開始日以降の日付を指定してください」 |
| 期間範囲超過 | 「検索期間は1年以内を指定してください」 |
| 検索条件不正 | 「検索条件を正しく指定してください」 |
| データ取得エラー | 「操作ログの取得に失敗しました」 |
| CSVダウンロードエラー | 「CSVファイルの生成に失敗しました」 |
| 権限エラー | 「この機能の利用権限がありません」 |
| システムエラー | 「システムエラーが発生しました。管理者に連絡してください」 |

## 画面遷移
| アクション | 遷移先 |
|------------|--------|
| 検索ボタン押下 | 同画面（検索結果表示） |
| CSVダウンロードボタン押下 | ファイルダウンロード |
| キャンセルボタン押下 | ダッシュボード画面 |

## 更新履歴
| 更新日 | 更新内容 | 更新者 |
|--------|----------|--------|
| 2024/03/19 | 入力項目の詳細仕様・検証ルール・エラーメッセージ・画面遷移情報を追加 | システム開発者 |
